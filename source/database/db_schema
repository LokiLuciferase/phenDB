
PRAGMA foreign_keys = ON;

CREATE TABLE JOB (
  JobID TEXT PRIMARY KEY,
  UserIP TEXT,
  UserEmail TEXT,
  JobDate DATE,
  FolderPath TEXT,
  JobStatus TEXT
);

CREATE TABLE BIN (
  BinID TEXT PRIMARY KEY,
  JobID TEXT,
  GenomePath TEXT,
  Mdsum TEXT,
  IsValid BOOLEAN,
  FOREIGN KEY(JobID) REFERENCES JOB(JobID)
);

CREATE TABLE ENOG (
  EnogID TEXT PRIMARY KEY,
  EnogDescription TEXT
);

CREATE TABLE MODEL (
  ModelID TEXT PRIMARY KEY,
  ModelDescription TEXT,
  TrainDate DATE
);

CREATE TABLE MODEL_ENOG_RANKS (
  ID INTEGER PRIMARY KEY,
  ModelID TEXT,
  EnogID TEXT,
  InternalRank INTEGER,
  FOREIGN KEY(ModelID) REFERENCES MODEL(ModelID),
  FOREIGN KEY(EnogID) REFERENCES ENOG(EnogID)
);

CREATE TABLE RESULT_ENOG (
  ID INTEGER PRIMARY KEY,
  EnogID TEXT,
  BinID TEXT,
  FOREIGN KEY(EnogID) REFERENCES MODEL(EnogID),
  FOREIGN KEY(BinID) REFERENCES BIN(BinID)
);

CREATE TABLE RESULT_MODEL (
  ID INTEGER PRIMARY KEY,
  BinID TEXT,
  ModelID TEXT,
  Verdict BOOLEAN,
  Accuracy REAL,
  FPR REAL,
  FNR REAL,
  TrainDate DATE,
  FOREIGN KEY(ModelID) REFERENCES MODEL(ModelID),
  FOREIGN KEY(BinID) REFERENCES BIN(BinID)
);
